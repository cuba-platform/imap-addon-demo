<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<window xmlns="http://schemas.haulmont.com/cuba/window.xsd"
        caption="msg://caption"
        datasource="mailMessageDs"
        class="com.haulmont.components.samples.imap.web.demo.Demo"
        messagesPack="com.haulmont.components.samples.imap.web.demo">
<dsContext>
    <collectionDatasource id="mailMessageDs"
                          allowCommit="false"
                          class="com.haulmont.components.samples.imap.entity.MailMessage"
                          view="mailMessage-full">
        <query>
            <![CDATA[select msg from imapsample$MailMessage msg where msg.seen = true order by msg.seenTime desc]]>
        </query>
    </collectionDatasource>

</dsContext>
<layout spacing="true">
    <hbox caption="set custom flag" height="AUTO">
        <textField id="flagNameField" />
        <button caption="set flag" invoke="setFlag"/>
        <button caption="unset flag" invoke="unsetFlag"/>
    </hbox>
    <hbox caption="move to folder" height="AUTO">
        <textField id="folderNameField" />
        <button caption="move to folder" invoke="moveToFolder"/>
    </hbox>
    <table id="mailMessageTable" width="100%" height="100%">
        <actions>
            <action id="deleteMessageAction" caption="msg://deleteCaption" invoke="deleteMessage"/>
            <action id="markAsReadAction" caption="msg://markAsReadCaption" invoke="markAsRead"/>
            <action id="markAsImportantAction" caption="msg://markAsImportantAction" invoke="markAsImportant"/>
            <action id="showBodyAction" caption="Show body" invoke="showBody"/>
            <action id="showAttachmentsAction" caption="Show attachments" invoke="showAttachments"/>
        </actions>
        <columns>
            <column id="subject"/>
            <column id="date" />
            <column id="from"/>
            <column id="toList" />
            <column id="flagsList" />
            <column id="mailBox"/>
        </columns>
        <rows datasource="mailMessageDs"/>
        <buttonsPanel>
            <button caption="msg://checkNewMessage" invoke="showNewMessage"/>
            <button action="mailMessageTable.deleteMessageAction"/>
            <button action="mailMessageTable.markAsReadAction"/>
            <button action="mailMessageTable.markAsImportantAction"/>
            <button action="mailMessageTable.showBodyAction"/>
            <button action="mailMessageTable.showAttachmentsAction"/>
        </buttonsPanel>
        <rowsCount/>
    </table>
</layout>
</window>