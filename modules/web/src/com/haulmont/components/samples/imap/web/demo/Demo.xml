<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<window xmlns="http://schemas.haulmont.com/cuba/window.xsd"
        caption="msg://caption"
        class="com.haulmont.components.samples.imap.web.demo.Demo"
        datasource="imapMessageDs"
        messagesPack="com.haulmont.components.samples.imap.web.demo">
    <dsContext>
        <collectionDatasource id="imapMessageDs"
                              allowCommit="false"
                              class="com.haulmont.components.samples.imap.entity.ImapMessage"
                              view="imapMessage-full">
            <query>
                <![CDATA[select msg from imapsample$ImapMessage msg where msg.seen = true order by msg.seenTime desc]]>
            </query>
        </collectionDatasource>
    </dsContext>
    <layout expand="imapMessageTable"
            spacing="true">
        <hbox caption="set custom flag"
              spacing="true">
            <textField id="flagNameField"/>
            <button caption="set flag"
                    invoke="setFlag"/>
            <button caption="unset flag"
                    invoke="unsetFlag"/>
        </hbox>
        <hbox caption="move to folder"
              spacing="true">
            <textField id="folderNameField"/>
            <button caption="move to folder"
                    invoke="moveToFolder"/>
        </hbox>
        <table id="imapMessageTable"
               width="100%">
            <actions>
                <action id="deleteMessageAction"
                        caption="msg://deleteCaption"
                        invoke="deleteMessage"/>
                <action id="markAsReadAction"
                        caption="msg://markAsReadCaption"
                        invoke="markAsRead"/>
                <action id="markAsImportantAction"
                        caption="msg://markAsImportantAction"
                        invoke="markAsImportant"/>
                <action id="showBodyAction"
                        caption="Show body"
                        invoke="showBody"/>
                <action id="showAttachmentsAction"
                        caption="Download attachments"
                        invoke="downloadAttachments"/>
            </actions>
            <columns>
                <column id="subject"/>
                <column id="date"/>
                <column id="from"/>
                <column id="toList"/>
                <column id="flagsList"/>
                <column id="mailBox"/>
            </columns>
            <rows datasource="imapMessageDs"/>
            <rowsCount/>
            <buttonsPanel>
                <button caption="msg://checkNewMessage"
                        invoke="showNewMessage"/>
                <button action="imapMessageTable.deleteMessageAction"/>
                <button action="imapMessageTable.markAsReadAction"/>
                <button action="imapMessageTable.markAsImportantAction"/>
                <button action="imapMessageTable.showBodyAction"/>
                <button action="imapMessageTable.showAttachmentsAction"/>
            </buttonsPanel>
        </table>
    </layout>
</window>
